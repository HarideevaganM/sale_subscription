<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="account_move_form_inherit_sale_extended" model="ir.ui.view">
        <field name="name">account.move.form.inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//form/sheet/notebook/page/field[@name='line_ids']/tree/field[@name='partner_id']"
                   position="attributes">
                <attribute name="domain">['|', ('parent_id', '=', False), ('is_company', '=', True), ('state','=',
                    'confirm')]
                </attribute>
            </xpath>
        </field>
    </record>


    <record id="partner_sale_location_inherit_id" model="ir.ui.view">
        <field name="name">res.partner.sale.inherit</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='sales_purchases']/group/group[@name='sale']/field[@name='user_id']" position="before">
                <field name="customer"/>
            </xpath>
            <xpath expr="//page[@name='sales_purchases']/group/group[@name='purchase']" position="inside">
                <field name="supplier"/>
            </xpath>
            <field name="street" position="attributes">
                <attribute name="required">True</attribute>
            </field>
            <field name="city" position="attributes">
                <attribute name="required">True</attribute>
            </field>
            <field name="zip" position="attributes">
                <attribute name="required">True</attribute>
            </field>
            <field name="country_id" position="attributes">
                <attribute name="required">True</attribute>
            </field>
            <field name="vat" position="attributes">
                <attribute name="required">True</attribute>
            </field>
            <xpath expr="//form/sheet" position="before">
                <header>
                    <button name="action_confirm" string="Confirm" class="oe_highlight" states="draft" type="object"
                            groups="sales_team.group_sale_manager,account.group_account_user"/>
                    <button name="action_set_draft" string="Set To Draft" class="oe_highlight" states="confirm"
                            type="object" groups="sales_team.group_sale_manager,account.group_account_user"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,confirm"/>
                </header>
            </xpath>
            <field name='parent_id' position="attributes">
                <attribute name="domain">[('state', '=', 'confirm')]</attribute>
            </field>
        </field>
    </record>

    <record id="account.res_partner_action_supplier" model="ir.actions.act_window">
        <field name="context">{'search_default_supplier': 1,'res_partner_search_mode': 'supplier', 'default_is_company': True, 'default_supplier_rank': 1, 'default_supplier': True}</field>
    </record>

    <record id="account.res_partner_action_customer" model="ir.actions.act_window">
        <field name="context">{'search_default_customer': 1,'res_partner_search_mode': 'customer', 'default_is_company': True, 'default_customer_rank': 1, 'default_customer': 1}</field>
    </record>

    <record id="stock_picking_job_card_inherit" model="ir.ui.view">
        <field name="name">stock.picking.job.card.form</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">
            <field name='partner_id' position="attributes">
                <attribute name="domain">[('state','=', 'confirm')]</attribute>
            </field>
        </field>
    </record>

    <!--<record id="account_move_form_inherit_sale_extended" model="ir.ui.view">
        <field name="name">account.move.form.inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <field name='partner_id' position="attributes">
                <attribute name="domain">[('customer', '=', True), ('state','=', 'confirm')]</attribute>
            </field>
        </field>
    </record>-->

    <record id="fms_purchase_order_extended_views" model="ir.ui.view">
        <field name="name">purchase.order.inherit</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_form"/>
        <field name="arch" type="xml">
            <field name='partner_id' position="attributes">
                <attribute name="domain">[('supplier', '=',True), ('state','=', 'confirm')]</attribute>
            </field>
<!--            <field name='date_planned' position="attributes">-->
<!--                <attribute name="optional">show</attribute>-->
<!--            </field>-->
            <xpath expr ="//notebook/page/field/tree/field[@name='date_planned']" position="attributes">
                <attribute name="optional">show</attribute>
                <attribute name="string">Scheduled Date</attribute>
            </xpath>
        </field>
    </record>

    <!--<record id="move_extended_form_inherit" model="ir.ui.view">
        <field name="name">account.move.form.inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <field name='partner_id' position="attributes">
                <attribute name="domain">[('supplier', '=',True),('state','=', 'confirm')]</attribute>
            </field>
        </field>
    </record>-->

    <record id="job_card_extended_form_inherit" model="ir.ui.view">
        <field name="name">job.card.form.inherit</field>
        <field name="model">job.card</field>
        <field name="inherit_id" ref="fms_sale.job_order_form"/>
        <field name="arch" type="xml">
            <field name='company_id' position="attributes">
                <attribute name="domain">[('customer', '=',True),('state','=', 'confirm')]</attribute>
            </field>
        </field>
    </record>

    <!--<record id="repair_order_inherit_sale_extended" model="ir.ui.view">
        <field name="name">repair.order.form.inherit</field>
        <field name="model">repair.order</field>
        <field name="inherit_id" ref="repair.view_repair_order_form"/>
        <field name="arch" type="xml">
            <field name='partner_id' position="attributes">
                <attribute name="domain">[('customer', '=',True),('state','=', 'confirm')]</attribute>
            </field>
        </field>
    </record>-->

    <record id="website_support_ticket_inherit_sale_extended" model="ir.ui.view">
        <field name="name">website.support.ticket.form.view</field>
        <field name="model">website.support.ticket</field>
        <field name="inherit_id" ref="website_support.website_support_ticket_view_form"/>
        <field name="arch" type="xml">
            <field name='partner_id' position="attributes">
                <attribute name="domain">[('customer', '=',True), ('state','=', 'confirm')]</attribute>
            </field>
        </field>
    </record>

    <record id="sale_subscription_inherit_sale_extended" model="ir.ui.view">
        <field name="name">sale.subscription.form.view</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale_subscription.sale_subscription_order_view_form"/>
        <field name="arch" type="xml">
            <field name='partner_id' position="attributes">
                <attribute name="domain">[('customer', '=',True), ('state','=', 'confirm')]</attribute>
            </field>
        </field>
    </record>

    <record id="crm_inherit_sale_extended" model="ir.ui.view">
        <field name="name">crm.form.view.inherit</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="sale_crm.crm_case_form_view_oppor"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="after">
                <field name="customer_state" invisible="1"/>
            </xpath>
            <xpath expr="//button[@name='action_sale_quotations_new']" position="attributes">
                <attribute name="attrs">{'invisible': ['|', '|',('type', '=', 'lead'), ('customer_state', '!=', 'confirm'), '&amp;', ('probability', '=', 0), ('active', '=', False)]}</attribute>
            </xpath>
        </field>
    </record>

    <record id="sale_order_form_inherit_id" model="ir.ui.view">
        <field name="name">sale.order.inherit</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <field name='partner_id' position="attributes">
                <attribute name="domain">[('customer', '=',True), ('state','=', 'confirm')]</attribute>
            </field>
        </field>
    </record>
</odoo>