<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="delivery_note_report" model="ir.actions.report">
        <field name="name">Delivery Note/GRN Report</field>
        <field name="model">stock.picking</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">fms_sale.delivery_order_template</field>
        <field name="report_file">fms_sale.delivery_order_template</field>
        <field name="print_report_name">'Delivery Order' if object.picking_type_id.name == 'Delivery Orders' else 'GRN Report'</field>
        <field name="binding_model_id" ref="stock.model_stock_picking"/>
        <field name="binding_type">report</field>
    </record>
    
    <!--<report
        id="delivery_note_report"
        model="stock.picking"
        string="Delivery Note/GRN Report"
        report_type="qweb-pdf"
        name="fms_sale.delivery_order_template"
        file="fms_sale.delivery_order_template"
        print_report_name="'Delivery Order' if object.picking_type_id.name == 'Delivery Orders' else 'GRN Report'"
    />-->

    <template id="delivery_order_template">
		
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="web.basic_layout">
                <t t-set="total" t-value="[]"/>                 
                <t t-if="o and 'company_id' in o">
                    <t t-set="company" t-value="o.company_id.sudo()"/>
                </t>
				<t t-if="not o or not 'company_id' in o">
					<t t-set="company" t-value="res_company"/>
				</t>
                <table style="width:100%">
                    <div class="header" >
						<table style="width:100%" >
								<tr>
									<td style="padding-left:40%">
										<img   style="text-align:center;" t-if="o.company_id.logo" t-att-src="'data:image/png;base64,%s' % to_text(o.company_id.logo)"  width="190px"/>                                     
									</td>                                                                          
								</tr>
<!--
								<tr>
                                <td style="color:#024963;text-align:center;">
                                    <span t-field="company.name"></span><br/>
                                    <span style="color:#04596b;" t-field="company.street"></span>,
                                    <span t-field="company.street2"></span>,
                                    <span t-field="company.city"></span>,
                                    <span t-field="company.country_id"></span><br/>
                                    TEL. :<span t-field="company.phone"></span><span>|</span>
                                        <span t-field="company.email"></span><span>|</span>
                                        <span t-field="company.website"></span><span>.</span>                                                                    
                                </td>
                            </tr>
-->
                        <tr><td><br/></td></tr>
                        <tr><td><br/></td></tr>
                        <tr><td><br/></td></tr>
						</table>
                    </div>                  
<!--
                    <div class="footer" >
						<table style="width:70%" >
								<td width="40%"></td> 									
                                <td style="color:#024963;text-align:center;">
                                    <span t-field="company.name"></span><br/>
                                    <span style="color:#04596b;" t-field="company.street"></span>,
                                    <span t-field="company.street2"></span>,
                                    <span t-field="company.city"></span>,
                                    <span t-field="company.country_id"></span><br/>
                                    T. :<span t-field="company.phone"></span><span>|</span>
                                        <span t-field="company.email"></span><span>|</span>
                                        <span t-field="company.website"></span><span>.</span>                                                                    
                                </td>
								

                        <tr><td><br/></td></tr>
                        <tr><td><br/></td></tr>
                        <tr><td><br/></td></tr>
						</table>
                    </div>                  
-->
                    <div class="row">
                        <table width="100%">
							<tr>
								<tr><td><br/></td></tr>
							</tr>
                        </table>
                    </div>
                    <div class="row">
                        <table width="100%" class="table table-bordered">
                            <tr style="text-align:center;font-size:20px">
								<td>
									<t t-if = "o.picking_type_id.name == 'Delivery Orders'">									
										<b>Delivery Order</b>
									</t> 
									<t t-if = "o.picking_type_id.name=='Receipts'">	
										<t-value><strong>Goods Received Note(GRN)</strong></t-value>																		
									</t> 
								</td>
                            </tr>
                        </table>
                    </div>
                    <div class="row">
                        <table width="100%">
                            <!--<tr width="100%">
                                <td style="text-align:left;font-size:11px"><strong>Customer Details :</strong><span t-field="o.partner_id"></span></td>
                                <td style="text-align:left;padding-left:50%;font-size:11px"><strong>Document No. <span> </span><span>:</span></strong><span t-field="o.name"/></td>
                            </tr>-->
                            <tr width="100%">
								<td>
									<t t-if = "o.picking_type_id.name == 'Delivery Order'">									
										<strong>Customer Details :</strong><span t-field="o.partner_id"></span>
									</t> 
									<t t-if = "o.picking_type_id.name=='Receipts'">	
										<strong>Supplier Details :</strong><span t-field="o.partner_id"></span>																		
									</t> 
								</td>
<!--
                                <td style="text-align:left;font-size:14px;width:50%"><strong>Customer Details :</strong><span t-field="o.partner_id"></span></td>
-->
                                <td style="text-align:left;padding-left:12%;font-size:14px;width:50%"><strong>Document No. <span> </span><span>:</span></strong><span t-field="o.name"/></td>
                            </tr>
                            <tr width="100%">
                                <!--<td style="text-align:left"></td>-->
                                <td style="text-align:left;font-size:14px;width:50%"><strong>Address :</strong><span t-field="company.city"></span><span>,</span><span t-field="company.country_id"></span></td>
                                <td style="text-align:left;padding-left:12%;font-size:14px;width:50%"><strong>Shipping Date</strong><span> </span><span>:</span><span t-field="o.scheduled_date"/></td>

                            </tr>
                            <tr width="100%">
                                <td style="text-align:left;font-size:14px;width:50%"><strong>Telephone :</strong><span t-field="company.phone"></span></td>
                                <td style="text-align:left;padding-left:12%;font-size:14px;width:50%"><strong>Shipped by</strong><span> </span><span>:</span><span t-field="company.name"> </span></td>

                            </tr>
                            <tr width="100%">
                                <td>
                                </td>
                                <td style="text-align:left;padding-left:12%;font-size:14px;width:50%"><strong>Shipping Terms</strong><span> </span><span>:</span></td>
                            </tr>
                            <tr width="100%">
                                <td></td>
                                <td style="text-align:left;padding-left:12%;font-size:14px;width:50%"><strong>PO</strong><span></span> <span>:</span><span t-field="o.po_number"/></td>

                            </tr>

                            <tr width="100%">
                                <td></td>
                                <td style="text-align:left;padding-left:12%;font-size:14px;width:50%"><strong>PO Date :</strong><span> </span><span>:</span><span t-field="o.po_date"/></td>                                
                            </tr>
                            <tr><td><br/></td></tr>
                            <tr><td><br/></td></tr>
                            <tr><td><br/></td></tr>

                        </table>
                    </div>

                    <div class="row">
                        <table width="100%" class="table table-bordered">
                            <thead>
                                <th style="text-align:center;font-size:14px;color:#024963;"><strong>Sl.No.</strong></th>
                                <th  style="text-align:center;font-size:14px;color:#024963;"><strong>Description</strong></th>
                                <th  style="text-align:center;font-size:14px;color:#024963;"><strong>Serial Number / Item Code</strong></th>
                                <th  style="text-align:center;font-size:14px;color:#024963;"><strong>FW</strong></th>
                                <th  style="text-align:center;font-size:14px;color:#024963;"><strong>P.O</strong></th>
                                <th  style="text-align:center;font-size:14px;color:#024963;"><strong>Qty / Unit</strong></th>
                                <th  style="text-align:center;font-size:14px;color:#024963;"><strong>Qty / CTN</strong></th>
                                
                            </thead>
                            <tr >
                                <t t-set="counter" t-value="1"/>
                                <tr t-foreach="line_item(o)" t-as="line">
                                    <td  style="text-align:center;font-size:12px"><span t-esc="counter"></span><t t-set="counter" t-value="counter+1"/></td>
                                    <td style="text-align:center;font-size:12px"><span t-esc="line['pname']"/></td>
                                    <t t-if="line_item(o)">

                                            <td style="text-align:center;font-size:12px"><span t-esc="line['name']"/></td>

                                    </t>
                                    
                                    <t t-else="">
                                        <td style="padding:10px;text-align:center;font-size:12px"> </td>
                                    </t>
                                    <td> </td>
                                    <td> </td>
                                    <td  style="text-align:center;font-size:12px"><span t-esc="'%.0f'%line['qty']"/><t t-set="total" t-value="total+[line['qty']]"/></td>
                                    <td  style="text-align:center;font-size:12px"> </td>
                                </tr>
                                
                            </tr>
                        <tr>
                            <td style="text-align:center;font-size:12px"></td>
                            <td style="text-align:center;font-size:12px"></td>
                            <td style="text-align:center;font-size:12px"></td>
                            <td style="text-align:center;font-size:12px"></td>
                            <td style="text-align:center;font-size:12px">Total:</td>
                            <td style="text-align:center;font-size:12px"><t t-esc="'%.0f'%(sum(total))"/></td>
                            <td style="text-align:center;font-size:12px"></td>
                        </tr>
                        </table>
                    </div>
                    <div class="row">
                        <table>
                            <tr>Remarks:</tr>
                            <tr><td><br/></td></tr>
                            <tr><td><br/></td></tr>
                            <tr><td><br/></td></tr>
                            <tr><td><br/></td></tr>
                            <tr><td><br/></td></tr>
                            <tr><td><br/></td></tr>
                            <tr><td><br/></td></tr>
                            <tr><td><br/></td></tr>
                        </table>
                    </div>
                    <div>
                        <table width="100%">
                            <tr>
                                <span><i>Thanks for your business!</i></span><br/>
                                <tr><td><br/></td></tr>
                            </tr>
                            <tr width="100%">
                                <td style="border:1px solid black;" width="30%">
                                    <span style="padding-left:10px;padding-top:30px;font-size:12px">Goods received in good condition by:</span><br/><br/>
                                    <span style="padding-left:10px;padding-top:30px;">Name:</span><br/>
                                    <span style="padding-left:10px;">Position:</span><br/>
                                    <span style="padding-left:10px;">Signature:</span><br/>
                                    <span style="padding-left:10px;">Date:</span><br/>
                                
                                </td>
                                <td width="30%"></td>   
                                <td style="border:1px solid black;font-size:12px" width="30%">
                                    <span style="padding-left:10px;padding-top:30px;">Goods delivered by:</span><br/><br/>
                                    <span style="padding-left:10px;padding-top:30px;">Name:</span><br/>
                                    <span style="padding-left:10px;">Position:</span><br/>
                                    <span style="padding-left:10px;">Signature:</span><br/> 
                                    <span style="padding-left:10px;">Date:</span><br/>
                                </td>
                            </tr>       
                        </table>
                    </div>
                    <div class="footer">
						<table>							
							<tr>
								<td style="width:100%;">___________________________________________________________________________________________________________________________</td>
							</tr>
							<tr>
								 <td style="color:#024963;text-align:center;">
                                    <span t-field="company.street"></span>,
                                    <span t-field="company.street2"></span>,
                                    <span t-field="company.city"></span>,
                                    <span t-field="company.country_id"></span><span>|</span>
                                    Tel:<span t-field="company.phone"></span><span>|</span>
                                     Fax:<span t-field="company.fax_new"></span><span>|</span>
                                    <span t-field="company.email"></span><span>|</span>
                                    <span t-raw="company.website.replace('http://',' ')"/><span>.</span>
                                </td>
							</tr>
						</table>
                    </div>
                </table>
                </t>        
            </t>        
        </t>
    </template>
</odoo>
