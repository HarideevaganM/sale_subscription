<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="report_sale_invoice_inclusive" model="ir.actions.report">
        <field name="name">Sale Invoice - Inclusive</field>
        <field name="model">account.move</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">fms_sale.sale_invoice_report_inclusive</field>
        <field name="report_file">fms_sale.sale_invoice_report_inclusive</field>
<!--        <field name="print_report_name">'Delivery Order' if object.picking_type_id.name == 'Delivery Orders' else 'GRN Report'</field>-->
        <field name="binding_model_id" ref="account.model_account_move"/>
        <field name="binding_type">report</field>
    </record>

    <!--<report id="report_sale_invoice_inclusive"
        model="account.move"
        string="Sale Invoice - Inclusive"
        report_type="qweb-pdf"
        file="fms_sale.sale_invoice_report_inclusive"
        name="fms_sale.sale_invoice_report_inclusive"/>-->

    <template id="sale_invoice_report_inclusive">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="total" t-value="[]"/>
                <t t-call="web.basic_layout">
				<t t-if="o and 'company_id' in o">
					<t t-set="company" t-value="o.company_id.sudo()"/>
                </t>
				<t t-if="not o or not 'company_id' in o">
					<t t-set="company" t-value="res_company"/>
				</t>
                    <div class="page" style="font-size:13px">
                            <div class="header">
								<table style="width:100%">
									<tr>
										<td style="padding-left:30%" width="70%">
											<img t-if="res_company.logo" t-att-src="'data:image/png;base64,%s' % to_text(res_company.logo)" class="pull-left" width="250px"/>
										</td>										                                                                      
									</tr>
								</table>
							</div>
							<div class="row">
								<table width="100%">
									<tr>
										<tr><td><br/></td></tr>
									</tr>
								</table>
							</div>
                            <div class="row">
                                <table style="width:100%;" cellspacing="0">
                                    <tr>
                                        <td>
                                            <span> Bill To : </span><br/>
                                            <span> Attention : Manager, Accounting Services</span><br/><br/>
                                            <b><span style="font-size: 17px;" t-field="doc.partner_id.name"/></b><br/>
                                            <t t-if="doc.partner_id.street">
												<span t-field="doc.partner_id.street"/>
											</t>
                                            <t t-if="doc.partner_id.street2">
												<span t-field="doc.partner_id.street2"/>,
                                            </t>
                                            <t t-if="doc.partner_id.city">
												<span t-field="doc.partner_id.city"/>,
                                            </t>
                                            <t t-if="doc.partner_id.country_id">
												<span t-field="doc.partner_id.country_id"/><br/>
                                            </t>
                                            <t t-if="doc.partner_id.phone">
												<span> Tel No. : <span t-field="doc.partner_id.phone"/></span>
                                            </t>
<!--
                                            <span> Fax No. : </span>
-->
                                        </td>
                                         <td style="padding-left:260px">
                                            <b><span style="font-size:23px;color:#1f497d">INVOICE</span></b><br/>
                                             <span style="font-size: 14px;">Date : <span t-field="doc.invoice_date"/></span><br/>
                                             <t t-if="doc.number">
                                             <span style="font-size: 14px;">Invoice # : <span t-field="doc.name"/></span><br/>
                                             </t>
                                             <t t-if="doc.partner_id.customer_id">
                                             <span style="font-size: 14px;">Customer ID : <span t-field="doc.partner_id.customer_id"/></span><br/>
                                             <!--<span style="font-size: 14px;font-color:blue;">Customer Type : <span t-field="doc.partner_id.customer_types"/></span><br/>-->
                                             </t>
                                             <t t-if="doc.origin">
											 <span style="font-size: 14px;">Sale Order # : <span t-field="doc.origin"/></span><br/>
											 </t>
											 <t t-if="doc.client_ref">
											 <span style="font-size: 14px;">Ref #:<span t-field="doc.client_ref"/></span><br/>
											 </t>
											 <t t-if="doc.purchase_order_no">
											 <span style="font-size: 14px;">PO # : <span t-field="doc.purchase_order_no"/></span><br/>
											 </t>
											 <t t-if="doc.purchase_order_date">
											 <span style="font-size: 14px;">PO Date # : <span t-field="doc.purchase_order_date"/></span><br/>
											 </t>											 
                                             <t t-foreach="get_purchase_date(doc)" t-as="date">
												<t t-if="date['date_order']">
												<span>Purchase Date # : <span t-esc="date['date_order']"/></span><br/>
												</t>
                                             </t>
                                        </td>                                           
                                    </tr>
                                    <tr><td><br/></td></tr>
                                    <tr>
                                        <td>
                                            <span> Email : <span t-field="doc.partner_id.email"/></span>
                                        </td>
                                    </tr>
                                    <tr><td><br/></td></tr>
                                </table>
                            </div>
                            <div class="row">
                                <table style="width:100%;" cellpadding="1" cellspacing="0">
                                    <tr style="width:100%;background-color:#1f497d;">
                                        <td style="width:70%;"><br/></td>
                                    </tr>
                                    <tr><td><span>All details mentioned in this invoice are as supporting documents attached</span></td></tr>
                                    <tr><td><br/></td></tr>
                                    <tr><td><br/></td></tr>                                    
                                </table>
                            </div>                                                        
                            <div class="row">
                               <table class="table table-bordered" style="width:100%;cellspacing:0px; !important;font-family:Liberation Serif;" cellpadding="1">
                                    <thead style="font-size:14px;width:100%;" t-foreach="get_currency_name(doc)" t-as="data">
                                        <t>
                                            <th><center>Item #</center></th>
                                            <th style="width:11%;"><center>Part #</center></th>
                                            <th><center>Description</center></th>
                                            <th><center>QTY</center></th>
                                            <th><center>UOM</center></th>
                                            <th><center>Per Unit Rate</center></th>
                                            <th><center>Discount(%)</center></th>
                                            <th><center>Total Rate</center></th>
                                        </t>
                                    </thead>
                        <tbody class="invoice_tbody">
                            <t t-set="counter" t-value="1"/>
                            <tr t-foreach="doc.inclusive_invoice_line" t-as="l">
                                <td>
                                    <span style="text-align:center;" t-esc="counter"/><t t-set="counter" t-value="counter+1"/>
                                </td>
                                <td><span style="text-align:center;"  t-field="l.product_id.default_code"/></td>
                                <td><span style="text-align:center;"  t-esc="l.name[l.name.find('] ')+1:]"/></td>
<!--                                <td><span t-field="l.name"/></td>-->
                                <td class="text-right">
                                    <span t-field="l.product_uom_qty" t-options='{"widget": "integer"}'/>
                                </td>
                                <td>
                                    <span style="text-align:center;"  t-field="l.product_uom"  groups="uom.group_uom"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="l.price_unit" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                </td>
                                <td class="text-right">
                                    <span t-field="l.discount"/>
                                </td>
                                <td class="text-right" id="subtotal">
                                    <span t-field="l.price_subtotal" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                                <!--<table class="table table-bordered" style="width:100%;cellspacing:0px; !important;font-family:Liberation Serif;" cellpadding="1">
                                    <thead style="font-size:14px;width:100%;" t-foreach="get_currency_name(doc)" t-as="data">
                                        <t>
                                            <th><center>Item #</center></th>
                                            <th style="width:11%;"><center>Part #</center></th>
                                            <th><center>Description</center></th>
                                            <th><center>QTY</center></th>
                                            <th><center>UOM</center></th>
                                            <th><center>Rate <span t-esc="data['currency']"/></center></th>
                                            <th><center>Total <span t-esc="data['currency']"/></center></th>
                                        </t>
                                    </thead>
                                    <tbody>
                                         <t t-set="counter" t-value="1"/>
                                        <tr style="page-break-inside: avoid;font-size: 14px;width:100%;" t-foreach="get_product_details(doc)" t-as="data">
                                            <td>
                                                <span style="text-align:center;" t-esc="counter"/><t t-set="counter" t-value="counter+1"/>
                                            </td>
                                            <td><span style="text-align:left;" t-esc="data['code']"/></td>
											<td>
												<span style="text-align:left;" t-esc="data['name']"/>
												<br></br>
												<span style="text-align:left;" t-esc="data['desc']"/>
											</td>
                                            <td align="center"><span t-esc="'%.0f'%data['aty']"/></td>
                                            <td><span t-esc="data['u_name']"/></td>
                                            <td align="right"><span t-esc="data['price']"/></td>
                                            <td align="right"><span t-esc="data['tot']"/><t t-set="total" t-value="total+[data['tot']]"/></td>
                                        </tr>-->
                                        <!--<tr style="page-break-inside: avoid;font-size: 14px;width:100%;" t-foreach="doc.invoice_line_ids" t-as="data">
                                            <td>
                                                <span style="text-align:center;" t-esc="counter"/><t t-set="counter" t-value="counter+1"/>
                                            </td>
                                            <td><span style="text-align:left;" t-esc="data.product_id.default_code"/></td>
											<td>
												<span style="text-align:left;" t-esc="data.product_id.name"/>
												<br></br>
												<span style="text-align:left;" t-esc="data.name"/>
											</td>
                                            <td align="center"><span t-esc="data.quantity"/></td>
                                            <td><span t-esc="data.uom_id.name"/></td>
                                            <td align="right"><span t-esc="data.price_unit"/></td>
                                            <td align="right"><span t-esc="data.price_subtotal"/></td>
                                        </tr>-->
                                   <!-- </tbody>
                                </table>-->
                            </div>
                            <div class="row">
								<table width="100%" >
									<td>
										<p style="font-size:12px;">
											<b>IN WORDS:</b> - <span t-esc="convert_num_to_word(doc)"></span>  Only
										</p>
									</td>
									<td style="text-align:right;" t-foreach="get_currency_name(doc)" t-as="data">
												<b>Total : </b><span t-field="doc.amount_total" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'></span>
									</td>
								</table>
                            </div>
                            <div class="row">
                                <table style="width:100%;" cellpadding="1" cellspacing="0">
                                    <tr style="width:100%;">
                                        <td style="width:70%;">
											<b><span>Special Notes and Instructions :</span><br/></b>
                                        </td>
                                    </tr>
                                </table>
                                <br></br>
                            </div>
                            <div class="row">
                                <table style="width:60%;" cellpadding="1" cellspacing="0">
                                    <tr style="width:100%;">
                                        <td style="width:100%;border:1px solid black;padding-left:2px">
                                        <span>Please issue all payments on below bank account details:</span><br/>
                                        <span><b>Account Name :</b><span t-field="company.acc_name"/></span><br/>
                                        <span><b>Account Number :</b> <span t-field="company.account_number"/></span><br/>
                                        <span><b>Bank Name :</b><span t-field="company.bank_name"/></span><br/>
                                        <span><b>Branch Name :</b><span t-field="company.branch_name"/></span><br/>
                                        <span><b>SWIFT Code :</b><span t-field="company.shift_code"/></span>
                                        </td>
                                    </tr>
                                    <tr><td><br/></td></tr>
                                </table>
                            </div>
                            <div class="row">
                                <table style="width:100%;" cellpadding="1" cellspacing="0">
                                    <tr style="width:100%;"><td style="text-align:center;width:100%;"><br/></td></tr>
                                    <tr style="width:100%;"><td style="text-align:center;width:100%;"><br/></td></tr>
                                    <tr style="width:100%;"><td style="text-align:center;width:100%;"><br/></td></tr>
                                    <tr style="width:100%;"><td style="width:100%;"><b>Authorized Signatory &amp; Stamp</b></td></tr>
                                    <tr style="width:100%;"><td style="text-align:center;width:100%;"><br/></td></tr>
                                    <tr style="width:100%;"><td style="text-align:center;width:100%;"><br/></td></tr>
                                    <tr style="width:100%;"><td style="text-align:center;width:100%;"><br/></td></tr>
                                    <tr style="width:100%;"><td style="text-align:center;width:100%;"><br/></td></tr>
                                    <tr style="width:100%;"><td style="text-align:center;width:100%;"><b>Thank you for your business!</b></td></tr>
                                    <tr style="width:100%;"><td style="text-align:center;width:100%;"><br/></td></tr>
                                    <tr style="width:100%;"><td style="text-align:center;width:100%;">Should you have any enquiries concerning this invoice,<span> please contact Mr.Pasha on + 968 92934369</span></td></tr>
                                </table>
                            </div>
                    </div>
                    <p style="page-break-before:always;"> </p>
                    <div class="page" style="margin-left:15px;">
                        <div>
                            <t t-if="get_device_details(doc)">
                                <table class="table table-bordered" style="width:100%;cellspacing:0px; !important;font-family:Liberation Serif;" cellpadding="1">
                                    <thead style="font-size:14px;width:100%;">
                                        <th><center>S No.</center></th>
                                        <th><center>Device Serial</center></th>
                                        <th><center>Device Type</center></th>
                                        <th><center>Vehicle Description</center></th>
                                        <th><center>Reg.No.</center></th>
                                        <th><center>Chassis No.</center></th>
                                        <th><center>Installation Date</center></th>
                                        <th><center>Status</center></th>

                                    </thead>
                                    <tbody>
                                        <tr>
                                            <t t-set="counter" t-value="1"/>
                                                <tr t-foreach="get_device_details(doc)" t-as="a">
                                                    <td style="text-align:center;"><span t-esc="counter"></span><t t-set="counter" t-value="counter+1"/></td>
                                                    <td style="padding:10px;"><span t-esc="a['serial']"/></td>
                                                    <td style="padding:10px;"><span t-esc="a['device']"/></td>
                                                    <td style="padding:10px;"><span t-esc="a['vehicle_name']"/></td>
                                                    <td style="padding:10px;"><span t-esc="a['vehicle']"/></td>
                                                    <td style="padding:10px;"><span t-esc="a['chassis']"/></td>
                                                    <td style="padding:10px;"><span t-esc="a['ins_date']" t-field-options='{"format": "dd/MM/yyyy"}'/></td>
                                                    <t t-if="a['status']=='active'">
                                                        <td style="padding:10px;">Active</td>
                                                    </t>
                                                    <t t-if="a['status']=='in_active'">
                                                        <td style="padding:10px;">In Active</td>
                                                    </t>
                                                </tr>
                                        </tr>
                                    </tbody>
                                </table>
                            </t>
                        </div>
                    </div>
                    <div class="footer">
                        <table>
                            <tr>
                                <td style="width:100%;">_____________________________________________________________________________________________________________
                                </td>
                            </tr>
                            <tr>
                                 <td style="color:#024963;text-align:center;">
                                    <span style="color:#04596b;" t-field="company.street"></span>,
                                    <span t-field="company.street2"></span>,
                                    <span t-field="company.city"></span>,
                                    <span t-field="company.country_id"></span><span>|</span>
                                    Tel:<span t-field="company.phone"></span><span>|</span>
                                     Fax:<span t-field="company.fax_new"></span><span>|</span>
                                    <span t-field="company.email"></span><span>|</span>
                                    <span t-raw="company.website.replace('https://','')"/><span>.</span>
                                </td>
                            </tr>
                        </table>
                    </div>
                </t>
            </t>
        </t>
    </template>
</odoo>
