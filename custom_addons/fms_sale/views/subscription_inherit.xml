<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="sale_subscription_form_inherit_id" model="ir.ui.view">
        <field name="name">sale.subscription.inherit</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale_subscription.sale_subscription_order_view_form"/>
        <field name="arch" type="xml">
            <field name="end_date" position="after">
                <field name="category" invisible="1"/>
            </field>

            <field name="partner_id" position="after">
                <field name="customer_types"/>
                <field name="contract_type"/>
                <field name="is_reseller" invisible="1"/>
            </field>
            <field name="pricelist_id" position="after">
                <field name="invoice_type" widget="radio"/>
                <field name="start_date"/>
                <field name="end_date"/>
                <field name="sale_order_id"/>
                <field name="sale_type"/>
                <field name="imei_no"/>
                <field name="gsm_number"/>
                <field name="engineer_id"/>
                <field name="renewal_date"/>
                <field name="invoiced_date" invisible="1"/>
                <field name="validation_date" invisible="1"/>
                <field name="store_end_date" invisible="1"/>
                <field name="serial_no"/>
                <field name="vehicle_number"/>
                <field name="installation_date"/>
                <field name="activation_date"/>
                <field name="renewal_status" invisible="1"/>
                <field name="invoice_status" invisible="1"/>
                <field name="subscription_status" invisible="1"/>
                <field name="billing_days" invisible="1"/>
                <field name="prorate_invoice_count" invisible="1"/>
                <field name="bill_start_date" invisible="1"/>
                <field name="bill_end_date" invisible="1"/>
                <field name="auto_renewal"/>
                <field name="auto_bill"/>
                <field name="subscription_period"/>
            </field>
            <button name="prepare_renewal_order" position="replace">
                <button string="Renewal Quotation"
                        help="Create a sale order that will overwrite this subscription when confirmed (renewal quotation)"
                        name="prepare_renewal_order" type="object"/>
<!--                        attrs="{'invisible':[('renewal_status', 'in', ('renewed','na'))]}"/>-->
            </button>
<!--            <field name="close_reason_id" position="before">-->
<!--                <field name="subscription_period"/>-->
<!--            </field>-->
            <xpath expr="//page[2]" position='after'>
                <page string="Notes">
                    <group>
                        <field name="note"/>
                    </group>
                </page>
            </xpath>
<!--            <xpath expr="//button[@name='prepare_renewal_order']" position="after">-->
<!--                <button class="oe_stat_button"-->
<!--                        icon="fa-globe"-->
<!--                        name="open_website_url"-->
<!--                        type="object"-->
<!--                        string="Online Preview" invisible="1">-->
<!--                </button>-->
<!--            </xpath>-->
            <field name="company_id" position="attributes">
                <attribute name='invisible'>1</attribute>
            </field>
<!--            <button name="abcd" position="attributes">-->
<!--                <attribute name="invisible">1</attribute>-->
<!--            </button>-->
            <field name="partner_id" position="attributes">
                <attribute name="string">Client Name</attribute>
            </field>
<!--            <button name="prepare_renewal_order" position="after">-->
<!--                <button string="&#8658; Generate Invoice" class="oe_link" name="generate_recurring_invoice"-->
<!--                        type="object"/>-->
<!--            </button>-->
            <field name="state" position="before">
                <button name="run_compute_manual" type="object" string="Run Compute Manually"
                        groups="base.group_no_one"/>
            </field>
            <field name="pricelist_id" position="after">
                <field name="date" readonly="1" force_save="1"/>
            </field>
<!--            <button name="start_subscription" position="attributes">-->
<!--                <attribute name="attrs">{'invisible': [('stage_category', '=', 'progress')]}</attribute>-->
<!--            </button>-->
        </field>
    </record>

    <record id="sale_subscription_list_inherit_id" model="ir.ui.view">
        <field name="name">sale.subscription.list.inherit</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale_subscription.sale_subscription_view_tree"/>
        <field name="arch" type="xml">
            <field name="partner_id" position="after">
                <field name="vehicle_number"/>
                <field name="serial_no"/>
                <field name="date_start"/>
                <field name="subscription_period"/>
                <field name="store_end_date"/>
                <field name="subscription_status" string="Device Status"/>
                <field name="renewal_date"/>
            </field>
            <field name="user_id" position="attributes">
                <attribute name='invisible'>1</attribute>
            </field>
<!--            <field name="recurring_next_date" position="attributes">-->
<!--                <attribute name='invisible'>1</attribute>-->
<!--            </field>-->
            <field name="stage_id" position="after">
                <field name="status_renewal"/>
            </field>
            <field name="stage_id" position="attributes">
                <attribute name='invisible'>1</attribute>
            </field>
            <field name="company_id" position="attributes">
                <attribute name='invisible'>1</attribute>
            </field>
        </field>
    </record>

    <record id="sale_subscription_search_inherit_id" model="ir.ui.view">
        <field name="name">sale.subscription.search.inherit</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale_subscription.sale_subscription_view_search"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='closed']" position="after">
                <filter name="type_sale" string="Sale Type" context="{'group_by':'sale_type'}"/>
                <filter name="number_vehicle" string="Vehicle Number" context="{'group_by':'vehicle_number'}"/>
                <filter name="number_serial" string="Device Serial Number" context="{'group_by':'serial_no'}"/>
                <filter name="renewal_status" string="Renewal Status" context="{'group_by':'status_renewal'}"/>
                <field string="Vehicle" name="vehicle_number"/>
                <field string="Device Serial No" name="serial_no"/>
            </xpath>
        </field>
    </record>

    <record id="sale_subscription.sale_subscription_action_pending" model="ir.actions.act_window">
        <field name="name">Subscriptions to Renew</field>
        <field name="res_model">sale.order</field>
        <field name="view_mode">tree,form,pivot,graph</field>
        <field name="context">{'search_default_renewal_status':1, 'search_default_is_subscription': True,
            'default_is_subscription': True}
        </field>
        <field name="domain">[('is_subscription', '=', True)]</field>
        <field name="search_view_id" eval='False'/>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Click to define a new subscription.
            </p>
            <p>
                You will find here the subscriptions to be renewed because the
                end date is passed or the working effort is higher than the
                maximum authorized one.
            </p>
            <p>
                Odoo automatically sets subscriptions to be renewed in a pending
                state. After the negociation, the salesman should close or renew
                pending subscriptions.
            </p>
        </field>
    </record>

    <record id="installation_certificate_action" model="ir.actions.act_window">
        <field name="name">Renewal Certificate List</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">installation.certificate</field>
        <field name="view_mode">tree,form</field>
    </record>

    <menuitem id="menu_installation_list" name="Renewal Certificate List" action="installation_certificate_action"
              parent="sale_subscription.menu_sale_subscription" sequence="201"/>

    <record id="view_subscription_invoice_renewal" model="ir.ui.view">
        <field name="name">subscription.renewal.list.wizard.form</field>
        <field name="model">subscription.renewal.list.wizard</field>
        <field name="arch" type="xml">
            <form string="Subscription Renewal">
                <group>
                    <group>
                        <field name="start_date"/>
                        <field name="end_date"/>
                        <field name="month_period"/>
                    </group>
                </group>
                <footer>
                    <button string='Update' name="update_renewal" type="object" class="btn-primary"/>
                    <button string="Cancel" class="btn-default" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>
    <record id="action_subscription_invoice_renewal" model="ir.actions.act_window">
        <field name="name">Renew Subscription</field>
        <field name="res_model">subscription.renewal.list.wizard</field>
        <field name="binding_model_id" ref="sale_subscription.model_sale_order"/>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">{'key2': 'client_action_multi'}</field>
    </record>

    <record id="view_invoice_state_list" model="ir.ui.view">
        <field name="name">invoice.state.list.wizard.form</field>
        <field name="model">invoice.state.list.wizard</field>
        <field name="arch" type="xml">
            <form string="Update Invocie State">
                <group>
                    <group>
                        <field name="invoice_date"/>
                    </group>
                </group>
                <footer>
                    <button string='Update' name="update_invoice_state" type="object" class="btn-primary"/>
                    <button string="Cancel" class="btn-default" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <record id="action_invoice_state_list" model="ir.actions.act_window">
        <field name="name">Update Invoice Status</field>
        <field name="res_model">invoice.state.list.wizard</field>
        <field name="binding_model_id" ref="sale_subscription.model_sale_order"/>
        <field name="view_mode">list,form</field>
        <field name="target">new</field>
        <field name="context">{'key2': 'client_action_multi'}</field>
    </record>
</odoo>			
