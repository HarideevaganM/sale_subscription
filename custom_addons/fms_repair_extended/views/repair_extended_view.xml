<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="job_card_extended_form_gfms_inherit" model="ir.ui.view">
        <field name="name">job.card.form.gfms.inherit</field>
        <field name="model">job.card</field>
        <field name="inherit_id" ref="fms_sale.job_order_form"/>
        <field name="arch" type="xml">
            <field name='device_serial_number_old_id' position="attributes">
                <attribute name="attrs">{'invisible': [],'readonly':[('state','=','done')]}</attribute>
            </field>
        </field>
    </record>

    <record id="close_subcription_wizard_form" model="ir.ui.view">
        <field name="name">subcription.close.wizard</field>
        <field name="model">subcription.close.wizard</field>
        <field name="arch" type="xml">
            <form string="Subcription Close Wizard">
                <group class="oe_title">
                    <p>
                        <b>Do you want to close subscription ?</b>
                    </p>
                </group>
                <footer>
                    <button name='action_subcription_close' type="object" string="OKAY" class="oe_highlight"/>
                    <button name='no_action_subcription_close' type="object" string="NO" class="oe_highlight"/>
                </footer>
            </form>
        </field>
    </record>

    <record id="close_subcription_form_wiz_action" model="ir.actions.act_window">
        <field name="name">Subcription Close Wizard</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">subcription.close.wizard</field>
        <field name="view_mode">form</field>
        <field name="view_id" ref="close_subcription_wizard_form"/>
        <field name="target">new</field>
    </record>

    <record id="view_fms_repair_location_form" model="ir.ui.view">
        <field name="name">stock.fms.repair.location.form</field>
        <field name="model">stock.location</field>
        <field name="inherit_id" ref="stock.view_location_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='usage']" position="after">
                <field name='loc_interanl_type' string='Internal Type'/>
            </xpath>
        </field>
    </record>

    <record id="repair_device_mantainace_inherit" model="ir.ui.view">
        <field name="name">repair.order.device.mantainace.inherit</field>
        <field name="model">repair.order</field>
        <field name="inherit_id" ref="fms_repair.repair_models_request_inherit"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='assign_to_research']" position="replace"></xpath>
        </field>
    </record>

    <record id="repair_website_support_inherit_view" model="ir.ui.view">
        <field name="name">repair.website.support.inherit.view</field>
        <field name="model">website.support.ticket</field>
        <field name="inherit_id" ref="website_support.website_support_ticket_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='create_job_card']" position="replace"></xpath>
            <xpath expr="//field[@name='vehicle_id']" position="attributes">
                <attribute name='domain'>[('partner_id', '=', partner_id)]</attribute>
            </xpath>
        </field>
    </record>

    <record id="res_inherit_repair_inh" model="ir.ui.view">
        <field name="name">mrp.support.repair.form.inherit</field>
        <field name="model">repair.order</field>
        <field name="inherit_id" ref="repair.view_repair_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='action_created_invoice']" position="replace">
                <button name="action_created_invoice" type="object" class="oe_stat_button" icon="fa-pencil-square-o"
                        attrs="{'invisible': [('invoice_count', '=', 0)]}">
                    <field string="Invoices" name="invoice_count" widget="statinfo"/>
                </button>
            </xpath>
            <xpath expr="//button[@name='action_repair_end_delivery']" position="replace">
                <button name="action_repair_end_delivery" type="object" string="End Maintenance" class="oe_highlight"
                        states="ready"/>
            </xpath>
            <xpath expr="//field[@name='invoice_method']" position="before">
                <field name="repair_job_type" readonly='1'/>
            </xpath>
            <xpath expr="//field[@name='invoice_method']" position="attributes">
                <attribute name='attrs'>{'readonly': []}</attribute>
            </xpath>
            <xpath expr="//field[@name='pricelist_id']" position="after">
                <field name="support_id" options="{'no_create': '1'}"/>
                <field name="vechicle_id" domain="[('device_id', '=', product_id)]"
                       context="{'default_device_id': product_id, 'default_partner_id': partner_id}"
                       attrs="{'readonly': [('state', '=', 'done')]}"/>
                <field name="return_lot_id" domain="[('product_id', '=', product_id)]"
                       context="{'default_product_id': product_id}" attrs="{'readonly': [('state', '=', 'done')]}"
                       options="{'no_create': '1'}"/>
            </xpath>
        </field>
    </record>

    <record id="repair_inherit_website_support_ticket" model="ir.ui.view">
        <field name="name">repair.inherit.website.support.ticket</field>
        <field name="model">website.support.ticket</field>
        <field name="type">form</field>
        <field name="inherit_id" ref="website_support.website_support_ticket_view_form"/>
        <field name="arch" type="xml">
            <div class="oe_button_box" position="inside">
                <button class="oe_stat_button" name="open_repair_view" type="object" icon="fa-list-ol">
                    <field string="Repairs" name="sup_repair_count" widget="statinfo"/>
                </button>
            </div>
            <xpath expr="//button[@name='confirm_repair_order']" position="after">
                <button name="create_repair" type="object" string="Create Repair"
                        attrs="{'invisible':['|', ('repair_job_type','=', 'non_technical'),('states', 'not in', ('confirmed', 'under_repair'))]}"
                        class="oe_highlight"/>
            </xpath>
            <field name="support_comment" position="after">
                <field name="job_card_type" required='1'/>
                <field name="repair_job_type" required='1'/>
            </field>
        </field>
    </record>

    <record id="email_template_maintenance_confirm" model="mail.template">
        <field name="name">Pending application forms</field>
        <field name="model_id" ref="fms_repair_extended.model_repair_order"/>
        <field name="subject">Email Notification</field>
        <field name="email_from">{{object.company_id.email}}</field>
        <field name="email_to">{{ object.user_id.login }}</field>
        <field name="auto_delete" eval="False"/>
        <field name="body_html" type="html">
            <table border="0" cellpadding="0" cellspacing="0" width="1000"
                   style="background-color: white; border-collapse: collapse; margin-left: 5px;">
                <tr>
                    <td valign="top" style="padding: 0px 10px;">
                        <div style="font-size: 13px; margin: 0px; padding: 0px;">
                            Dear <t t-esc="object.user_id.name"/>,
                            <br/>
                            We've identified a process anomaly with the
                            <t t-esc="object.lot_id.name"/> <t t-if="object.partner_id.city">
                            at<t t-esc="object.partner_id.city"/> </t>. Your prompt attention is needed.
                            <br/>
                            Details:
                            <br/>
                            <br/>Device: <t t-esc="object.lot_id.name"/>
                            <br/>Customer: <t t-esc="object.partner_id.name"/>
                            <br/>Address: <t t-esc="object.partner_id.street"/><t t-if="object.partner_id.street">,</t><t t-esc="object.partner_id.street2"/><t t-if="object.partner_id.street2">,</t><t t-esc="object.partner_id.city"/><t t-if="object.partner_id.city">,</t><t t-esc="object.partner_id.zip"/>
                            <br/>Scheduled Date: <t t-esc="object.schedule_date"/>
                            <br/><br/>
                            <t t-if="object.vehicle_id.name">
                                <br/>Vehicle ID:
                                <t t-esc="object.vehicle_id.name"/>
                                <br/>
                            </t>
                            <br/>
                            <t t-if="object.schedule_date">
                                <br/>Scheduled Date:
                                <t t-esc="object.schedule_date"/>
                                <br/>
                            </t>
                            Please inspect, deactivate, replace components as needed. Report any challenges.
                            <br/>
                        </div>
                    </td>
                </tr>
            </table>
        </field>
    </record>

</odoo>